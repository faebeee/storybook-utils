import {Meta} from "@storybook/addon-docs/blocks";

<Meta title="storybook-w3c/readme"/>

# storybook-w3c

Validate your rendered Storybook stories with the W3C HTML Validator — right inside Storybook’s UI.

This addon collects the rendered HTML of the current story and sends it to the official W3C Nu validator (https://validator.w3.org/nu/) using the "Inline" doctype. Validation results (errors, warnings, and extracts) are displayed in a dedicated "W3C" panel.

> Targets Storybook 10+ with the React-based manager UI. Peer deps: React 18+, `storybook@^10.1.4`.

## Features
- One-click W3C validation of the currently rendered story
- Results panel with message type, message text, and source extract
- Framework-agnostic (validates final HTML, not framework code)

## Installation
```bash
# with npm
npm install --save-dev storybook-w3c

# with pnpm
pnpm add -D storybook-w3c

# with yarn
yarn add -D storybook-w3c
```

Peer dependencies you should already have in your Storybook project:
- react >= 18
- react-dom >= 18
- storybook ^10.1.4

## Usage
```ts
// .storybook/main.ts
import type { StorybookConfig } from '@storybook/react-vite';

const config: StorybookConfig = {
  stories: ['../src/**/*.stories.@(ts|tsx)'],
  addons: [
    // ...other addons
    'storybook-w3c',
  ],
  framework: '@storybook/react-vite',
};

export default config;
```

Open the Storybook UI and select the "W3C" panel at the bottom to validate the currently displayed story.

## How it works
- A preview decorator collects the innerHTML of the story root after render and emits a `CODE_UPDATE` event.
- The manager-side addon listens for `CODE_UPDATE`, posts the HTML to `https://validator.w3.org/nu/?out=json&doctype=Inline` with `Content-Type: text/html`, and renders the returned messages in a table.

## Privacy and networking
This addon sends the rendered HTML of your story to the public W3C validation service over the network. Do not enable this addon when viewing proprietary or sensitive HTML you don’t want to share outside your environment. For offline or private validation, fork the addon and point it to a self-hosted instance of the Nu validator.

## License
ISC © faebeee
